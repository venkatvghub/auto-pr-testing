<div id="main-content" class="p-4">
    <div id="search-bar-container" class="flex items-center mb-4">
        <p class="m-2 flex items-center">Namespace:</p>
        <input id="namespace-search" type="text" placeholder="Search namespaces..." 
               class="h-8 px-4 text-sm text-grey-700 border border-grey-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-grey-800">
    </div>
    <div id="table-container">
        <table class="min-w-full leading-normal">
            <thead>
                <tr>
                    <th class="px-5 py-3 border-b-2 border-grey-200 bg-grey-700 text-left text-xs font-semibold text-white-100 uppercase tracking-wider">
                        Cloned-namespace
                    </th>
                    <th class="px-5 py-3 border-b-2 border-grey-200 bg-grey-700 text-left text-xs font-semibold text-white-100 uppercase tracking-wider">
                        Source-namespace
                    </th>
                    <th class="px-5 py-3 border-b-2 border-grey-200 bg-grey-700 text-left text-xs font-semibold text-white-100 uppercase tracking-wider">
                        Owner
                    </th>
                    <th class="px-5 py-3 border-b-2 border-grey-200 bg-grey-700 text-left text-xs font-semibold text-white-100 uppercase tracking-wider">
                        Cloned At
                    </th>
                </tr>
            </thead>
            <tbody id="namespace-table">
                {{range .data}}
                <tr class="bg-white-100">
                    <td class="px-5 py-2 border-b border-grey-200 text-sm">
                        <a href="#" data-namespace="{{.namespace}}" class="namespace-link text-blue-500 hover:text-blue-800">
                            {{.namespace}}
                        </a>
                    </td>
                    <td class="px-5 py-2 border-b border-grey-200 text-sm">
                        {{.sourceNamespace}}
                    </td>
                    <td class="px-5 py-2 border-b border-grey-200 text-sm">
                        {{.owner}}
                    </td>
                    <td class="px-5 py-2 border-b border-grey-200 text-sm">
                        {{.creationTimestamp}}
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    <div id="namespace-details-wrapper" style="display: none;">
        <div id="namespace-header" class="flex justify-between items-center mb-4">
            <div id="namespace-name" class="text-xl font-semibold"></div>
            <button id="back-button" class="px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-700">
                Back
            </button>
        </div>
        <div id="namespace-details"></div>
        <!-- Content will be loaded here via HTMX -->
    </div>
</div>

<div style="position: absolute; top: 0; right: 0;">
    <div class="toast center" role="alert" aria-live="assertive" aria-atomic="true" data-delay="5000">
        <div class="toast-header">
            <strong class="mr-auto">Alert</strong>
            <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="toast-body" style="text-align: center;">
            Scaling namespaces was successful!
        </div>
    </div>
</div>

<script>
document.getElementById('namespace-search').addEventListener('input', function() {
    const searchValue = this.value.toLowerCase();
    const rows = document.querySelectorAll('#namespace-table tr');

    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        let rowContainsSearchValue = false;

        cells.forEach(cell => {
            if (cell.textContent.toLowerCase().includes(searchValue)) {
                rowContainsSearchValue = true;
            }
        });

        if (rowContainsSearchValue) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
});

document.querySelectorAll('.namespace-link').forEach(link => {
    link.addEventListener('click', function(event) {
        event.preventDefault();
        const namespace = this.getAttribute('data-namespace');
        // Hide search bar and table, show namespace details
        document.getElementById('search-bar-container').style.display = 'none';
        document.getElementById('table-container').style.display = 'none';
        document.getElementById('namespace-details-wrapper').style.display = 'block';
        document.getElementById('namespace-name').textContent = namespace;
        // Trigger HTMX request
        htmx.ajax('GET', `/ui/v1/namespace/details?namespaceId=${namespace}`, '#namespace-details', { trigger: 'load' });
    });
});

document.getElementById('back-button').addEventListener('click', function() {
    // Show search bar and table, hide namespace details
    document.getElementById('search-bar-container').style.display = 'flex';
    document.getElementById('table-container').style.display = 'block';
    document.getElementById('namespace-details-wrapper').style.display = 'none';
});
</script>
